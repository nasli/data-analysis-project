---
title: "Proyecto Final - KeepCoding Mujeres en Tech II"
author: ''
subtitle: ''
editor: visual
table-of-contents: true
output: pdf_document
---

## Data Set

```{r, echo=FALSE, include=FALSE}
library(tidyverse)
library(magrittr)
data = read_csv('air-bnb-listings.csv')
```

## Arquitectura y validación de los datos

a.  Muestreo y exploración inicial de los datos

```{r, include=TRUE, echo=FALSE}
paste("El dataset tiene:", dim(data)[1], "filas y " , dim(data)[2], "columnas.")
paste("Las variables que tenemos son: ")
paste(colnames(data))
```

Aplicamos los cambios que hemos observado en el análisis inicial antes de realizar el análisis de las variables cuantitativas.

```{r}
data[,c("room_id", "host_id")] %<>%  toString()
data$number_of_reviews_per_month %<>%  as.numeric()
data$lat <- data$coordinates %>% str_split_i(', ', 1) %>% as.numeric()
data$long <- data$coordinates %>% str_split_i(', ', 2) %>%  as.numeric()
```

Analizamos cuántos valores distintos tienen las variables cualitativas:

```{r}
data %>% select_if(where(is.character)) %>% map_dfc(n_distinct)
```

Las variables City y Country deberían tener un único valor, ya que solo nos centramos en una ciudad y en un país.

```{r}
print('Ciudades únicas:')
data$city %>% unique()

print('Países únicas:')
data$country %>% unique()
```

```{r}
data = data[data$city=="Madrid",]

```

```{r}
data %>% select_if(where(is.character)) %>% map_dfc(n_distinct)
```

b.  Definir e implementar el Datawarehouse

```{r}
data[is.na(data$number_of_reviews_per_month), 'number_of_reviews_per_month'] = 0
```

c.  (Opcional) Ingesta de datos (ETL) y validación de que se ha cargado correctamente

## Análisis Exploratorio

Hacer un estudio estadístico con R o Python, según preferencia personal, y averiguar cuales son las métricas adecuadas para el dataset. No olvidemos: a. Revisión de la calidad de los datos b. Detección outliers (rango de variables), imputación valores nulos. c. Boxplots, histogramas, etc. d. Normalización de los valores de las tablas (quitar tildes, “dobles espacios”, etc.)

```{r}
data %>% select_if(where(is.numeric)) %>% summary()
```

En las variables room_price y minimum_nights tiene un máximo muy lejano al tercer cuartil, vamos a analizar si estos valores se pueden considerar válidos o no.

```{r}
data %>% select ('room_type','room_price', 'minimum_nights') %>%
  ggplot( aes(x=room_type, y=minimum_nights, fill=room_type)) +
    geom_boxplot() +
 #   scale_fill_viridis(discrete = TRUE, alpha=0.6, option="A") +
  #  theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    ggtitle("") +
    xlab("")
```

```{r}
data %>% select ('room_type','room_price', 'minimum_nights') %>%
  ggplot( aes(x=room_type, y=room_price, fill=room_type)) +
    geom_boxplot() +
 #   scale_fill_viridis(discrete = TRUE, alpha=0.6, option="A") +
  #  theme_ipsum() +
    theme(
      legend.position="none",
      plot.title = element_text(size=11)
    ) +
    ggtitle("") +
    xlab("")
```

```{r}
data$room_type %>% table() %>% barplot()
```

## Visualización de las métricas

A partir de los datos de Airbnb, obtén los KPIs que puedan ser de relevancia y contesta a través de un dashboard a una pregunta relevante que hagas sobre los datos. a. a. Se valorará el diseño final del dashboard. b. b. El uso de buenas prácticas. c. c. El cálculo de KPIs adecuados y el uso de campos calculados avanzados. d. d. El uso de vistas interactivas. Nota: En este ejercicio no habrá un dashboard modelo sino que se basará en valorar vuestras capacidades con el uso de la herramienta de Tableau y que podáis demostrar todo lo aprendido durante este bloque

```{r}

```

## Pre-procesamiento y Modelado

La tarea asignada es hacer un algoritmo de regresión lineal que prediga el precio de un inmueble en función de las características que elijáis

## **Informe**

En esta etapa se debe de simular la presentación de resultados en un entorno real de empresa. ● Suposiciones iniciales ○ Cuales han demostrado ser válidas y cuáles no. ¿Por qué? ● Métricas seleccionadas: ¿han sido las correctas o no? ¿por qué?

------------------------------------------------------------------------

Trás analizar los datos facilitados en el dataset, nos enfocamos a responder preguntas de un futuro anfitrion que quiere conocer la rentabilidad que tendría a la hora de ofertar un alojamiento teniendo en cuenta varias metricas como la zona, tipo de alojamiento, etc...

Visualizamos en Tableau varias metricas que nos ayudan a poder aconsejar a futuros host.

Para ello vemos primeramente la cantidad de Airbnb que hay en Madrid, 21.255 a fecha del dataset y vemos la cantidad de host que hay por barrios, siendo el barrio de Embajadores en el que más se concentran.

Tambien podemos ver que los alojamientos preferidos son el apartamento entero, seguido de la habitación privada.

![](images/primero.PNG)

Otro punto importante es ver el promedio de precios por distrito y por barrio. Aqui vemos los barrios y distritos más caros y más baratos y cual es el promedio total de todo Madrid, que se encuentra en 144,52€ precio por noche.

Siendo el precio medio más bajo el del barrio de Orcasur en Usera (31,96€) y el más alto el de Guindalera en el distrito de Salamanca (555,10€)

![](images/segundo.PNG)

Continuamos viendo cual ha sido la tendencia de crecimiento en los ultimos años desde sus inicios

![](images/1-01.PNG)

En este gráfico podemos ver la evolución desde los primeros Airbnb en Madrid en el año 2012. Existe un notable crecimiento a lo largo de los años y las zonas en las que más alojamientos hay por distrito, que se suele concentrar principalmente en el centro de la capital, debido a la amplia oferta turistica que existe.

![](images/3.PNG)

Como se puede ver, solo el distrito centro cuenta con 2.879 host y la media de precio son 158€/noche siendo, como ya hemos mencionado, el apartamento completo el tipo de alojamiento preferido por los usuarios.

Una vez conocemos la tendencia, vamos a ver la media de ingresos por año en cada barrio

![](images/2.PNG)

Como podemos comprobar, en los barrios más centricos es donde mayor media de ganancia existe al año, tambien porque es donde más alojamientos hay, por lo que debemos tener en cuenta este dato, ya que si se eligen estos barrios, contaremos con mayor competencia.

Por otro lado, nos aseguramos una mayor ocupación practicamente durante todo el año, ya que es la zona preferida por los turistas de todo el mundo. Como hemos comprobado, hay una notoria cantidad de alojamientos cuyos anuncios están en inglés y chino principalmente, aunque tambien hay anuncios en otros idiomas.

En la gráfica de "ocupacion al año" podemos apreciar que los primeros alojamientos que se ofrecian era el apartamento entero y habitación privada, y la tendencia fue cambiando a partir de 2015 donde apareció la habitación compartida y la habitación de hotel. No obstante, siguen siendo la habitación privada y el apartamento entero las estancias que más se alquilan, teniendo un promedio de ocupación de casi 200 dias al año.

La gráfica de "estimación de ganancias" nos muestra de un vistazo como se han incrementado las ganancias en los ultimos años.

**Estos datos se pueden ver con mayor detalle en el archivo adjunto"Proyecto_final.twbx"**

**NORMATIVA DE NO ALQUILAR POR MAS DE 90 NOCHES**

Según los datos estudiados en el dataset hay un porcentaje (6,7%) de viviendas que no cumplirian con la normativa conocida como "regla de los 90 dias"

El Plan Especial de Hospedaje (PEH), limita a 90 días la posibilidad de alquilar una vivienda con fines turísticos sin permiso y a partir de ese plazo obliga a obtener una licencia de uso terciario de hospedaje.

<https://www.madrid.es/portales/munimadrid/es/Inicio/Vivienda-y-urbanismo/Urbanismo/Plan-Especial-de-regulacion-del-uso-de-servicios-terciarios-en-la-clase-de-hospedaje/?vgnextoid=b71cbc8d3c9f4610VgnVCM1000001d4a900aRCRD&vgnextchannel=2af331d3b28fe410VgnVCM1000000b205a0aRCRD>

En el siguiente enlace podemos ver con más detalle la legislacion de la comunidad de Madrid sobre alquileres turisticos:

<https://www.comunidad.madrid/servicios/consumo/normativa-alojamientos-turisticos>

CONCLUSIONES

Lecciones aprendidas
